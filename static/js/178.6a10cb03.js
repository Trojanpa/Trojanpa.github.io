"use strict";(self["webpackChunkthree_demo2"]=self["webpackChunkthree_demo2"]||[]).push([[178],{5178:function(e,t,n){n.r(t),n.d(t,{default:function(){return ce}});var o=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},i=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"demo30"},[n("div",{attrs:{id:"demo30Id"}}),n("div",{attrs:{id:"stats30Id"}})])}],s=n(7662),r=n(9477);function a(e,t=!1){const n=null!==e[0].index,o=new Set(Object.keys(e[0].attributes)),i=new Set(Object.keys(e[0].morphAttributes)),s={},a={},c=e[0].morphTargetsRelative,l=new r.u9r;let d=0;for(let r=0;r<e.length;++r){const h=e[r];let p=0;if(n!==(null!==h.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+r+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const e in h.attributes){if(!o.has(e))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+r+'. All geometries must have compatible attributes; make sure "'+e+'" attribute exists among all geometries, or in none of them.'),null;void 0===s[e]&&(s[e]=[]),s[e].push(h.attributes[e]),p++}if(p!==o.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+r+". Make sure all geometries have the same number of attributes."),null;if(c!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+r+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const e in h.morphAttributes){if(!i.has(e))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+r+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===a[e]&&(a[e]=[]),a[e].push(h.morphAttributes[e])}if(l.userData.mergedUserData=l.userData.mergedUserData||[],l.userData.mergedUserData.push(h.userData),t){let e;if(n)e=h.index.count;else{if(void 0===h.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+r+". The geometry must have either an index or a position attribute"),null;e=h.attributes.position.count}l.addGroup(d,e,r),d+=e}}if(n){let t=0;const n=[];for(let o=0;o<e.length;++o){const i=e[o].index;for(let e=0;e<i.count;++e)n.push(i.getX(e)+t);t+=e[o].attributes.position.count}l.setIndex(n)}for(const r in s){const e=h(s[r]);if(!e)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+r+" attribute."),null;l.setAttribute(r,e)}for(const r in a){const e=a[r][0].length;if(0===e)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[r]=[];for(let t=0;t<e;++t){const e=[];for(let o=0;o<a[r].length;++o)e.push(a[r][o][t]);const n=h(e);if(!n)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+r+" morphAttribute."),null;l.morphAttributes[r].push(n)}}return l}function h(e){let t,n,o,i=0;for(let r=0;r<e.length;++r){const s=e[r];if(s.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===t&&(t=s.array.constructor),t!==s.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===n&&(n=s.itemSize),n!==s.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===o&&(o=s.normalized),o!==s.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;i+=s.array.length}const s=new t(i);let a=0;for(let r=0;r<e.length;++r)s.set(e[r].array,a),a+=e[r].array.length;return new r.TlE(s,n,o)}function c(e,t=1e-4){t=Math.max(t,Number.EPSILON);const n={},o=e.getIndex(),i=e.getAttribute("position"),s=o?o.count:i.count;let a=0;const h=Object.keys(e.attributes),c={},l={},d=[],p=["getX","getY","getZ","getW"];for(let r=0,w=h.length;r<w;r++){const t=h[r];c[t]=[];const n=e.morphAttributes[t];n&&(l[t]=new Array(n.length).fill().map((()=>[])))}const u=Math.log10(1/t),m=Math.pow(10,u);for(let r=0;r<s;r++){const t=o?o.getX(r):r;let i="";for(let n=0,o=h.length;n<o;n++){const o=h[n],s=e.getAttribute(o),r=s.itemSize;for(let e=0;e<r;e++)i+=~~(s[p[e]](t)*m)+","}if(i in n)d.push(n[i]);else{for(let n=0,o=h.length;n<o;n++){const o=h[n],i=e.getAttribute(o),s=e.morphAttributes[o],r=i.itemSize,a=c[o],d=l[o];for(let e=0;e<r;e++){const n=p[e];if(a.push(i[n](t)),s)for(let e=0,o=s.length;e<o;e++)d[e].push(s[e][n](t))}}n[i]=a,d.push(a),a++}}const g=e.clone();for(let w=0,f=h.length;w<f;w++){const t=h[w],n=e.getAttribute(t),o=new n.array.constructor(c[t]),i=new r.TlE(o,n.itemSize,n.normalized);if(g.setAttribute(t,i),t in l)for(let s=0;s<l[t].length;s++){const n=e.morphAttributes[t][s],o=new n.array.constructor(l[t][s]),i=new r.TlE(o,n.itemSize,n.normalized);g.morphAttributes[t][s]=i}}return g.setIndex(d),g}var l=n(9365);const d={type:"change"},p={type:"start"},u={type:"end"};class m extends r.pBf{constructor(e,t){super(),void 0===t&&console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');const n=this,o={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:r.RsA.ROTATE,MIDDLE:r.RsA.DOLLY,RIGHT:r.RsA.PAN},this.target=new r.Pa4;const i=1e-6,s=new r.Pa4;let a=1,h=o.NONE,c=o.NONE,l=0,m=0,g=0;const w=new r.Pa4,f=new r.FM8,y=new r.FM8,b=new r.Pa4,v=new r.FM8,M=new r.FM8,P=new r.FM8,E=new r.FM8,S=[],x={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const e=n.domElement.getBoundingClientRect(),t=n.domElement.ownerDocument.documentElement;n.screen.left=e.left+window.pageXOffset-t.clientLeft,n.screen.top=e.top+window.pageYOffset-t.clientTop,n.screen.width=e.width,n.screen.height=e.height};const j=function(){const e=new r.FM8;return function(t,o){return e.set((t-n.screen.left)/n.screen.width,(o-n.screen.top)/n.screen.height),e}}(),G=function(){const e=new r.FM8;return function(t,o){return e.set((t-.5*n.screen.width-n.screen.left)/(.5*n.screen.width),(n.screen.height+2*(n.screen.top-o))/n.screen.width),e}}();function C(e){!1!==n.enabled&&(0===S.length&&(n.domElement.setPointerCapture(e.pointerId),n.domElement.addEventListener("pointermove",T),n.domElement.addEventListener("pointerup",K)),L(e),"touch"===e.pointerType?D(e):R(e))}function T(e){!1!==n.enabled&&("touch"===e.pointerType?Y(e):k(e))}function K(e){!1!==n.enabled&&("touch"===e.pointerType?H(e):X(),Z(e),0===S.length&&(n.domElement.releasePointerCapture(e.pointerId),n.domElement.removeEventListener("pointermove",T),n.domElement.removeEventListener("pointerup",K)))}function I(e){Z(e)}function _(e){!1!==n.enabled&&(window.removeEventListener("keydown",_),c===o.NONE&&(e.code!==n.keys[o.ROTATE]||n.noRotate?e.code!==n.keys[o.ZOOM]||n.noZoom?e.code!==n.keys[o.PAN]||n.noPan||(c=o.PAN):c=o.ZOOM:c=o.ROTATE))}function A(){!1!==n.enabled&&(c=o.NONE,window.addEventListener("keydown",_))}function R(e){if(h===o.NONE)switch(e.button){case n.mouseButtons.LEFT:h=o.ROTATE;break;case n.mouseButtons.MIDDLE:h=o.ZOOM;break;case n.mouseButtons.RIGHT:h=o.PAN;break}const t=c!==o.NONE?c:h;t!==o.ROTATE||n.noRotate?t!==o.ZOOM||n.noZoom?t!==o.PAN||n.noPan||(P.copy(j(e.pageX,e.pageY)),E.copy(P)):(v.copy(j(e.pageX,e.pageY)),M.copy(v)):(y.copy(G(e.pageX,e.pageY)),f.copy(y)),n.dispatchEvent(p)}function k(e){const t=c!==o.NONE?c:h;t!==o.ROTATE||n.noRotate?t!==o.ZOOM||n.noZoom?t!==o.PAN||n.noPan||E.copy(j(e.pageX,e.pageY)):M.copy(j(e.pageX,e.pageY)):(f.copy(y),y.copy(G(e.pageX,e.pageY)))}function X(){h=o.NONE,n.dispatchEvent(u)}function O(e){if(!1!==n.enabled&&!0!==n.noZoom){switch(e.preventDefault(),e.deltaMode){case 2:v.y-=.025*e.deltaY;break;case 1:v.y-=.01*e.deltaY;break;default:v.y-=25e-5*e.deltaY;break}n.dispatchEvent(p),n.dispatchEvent(u)}}function D(e){switch(F(e),S.length){case 1:h=o.TOUCH_ROTATE,y.copy(G(S[0].pageX,S[0].pageY)),f.copy(y);break;default:h=o.TOUCH_ZOOM_PAN;const e=S[0].pageX-S[1].pageX,t=S[0].pageY-S[1].pageY;m=l=Math.sqrt(e*e+t*t);const n=(S[0].pageX+S[1].pageX)/2,i=(S[0].pageY+S[1].pageY)/2;P.copy(j(n,i)),E.copy(P);break}n.dispatchEvent(p)}function Y(e){switch(F(e),S.length){case 1:f.copy(y),y.copy(G(e.pageX,e.pageY));break;default:const t=Q(e),n=e.pageX-t.x,o=e.pageY-t.y;m=Math.sqrt(n*n+o*o);const i=(e.pageX+t.x)/2,s=(e.pageY+t.y)/2;E.copy(j(i,s));break}}function H(e){switch(S.length){case 0:h=o.NONE;break;case 1:h=o.TOUCH_ROTATE,y.copy(G(e.pageX,e.pageY)),f.copy(y);break;case 2:h=o.TOUCH_ZOOM_PAN,y.copy(G(e.pageX-f.x,e.pageY-f.y)),f.copy(y);break}n.dispatchEvent(u)}function z(e){!1!==n.enabled&&e.preventDefault()}function L(e){S.push(e)}function Z(e){delete x[e.pointerId];for(let t=0;t<S.length;t++)if(S[t].pointerId==e.pointerId)return void S.splice(t,1)}function F(e){let t=x[e.pointerId];void 0===t&&(t=new r.FM8,x[e.pointerId]=t),t.set(e.pageX,e.pageY)}function Q(e){const t=e.pointerId===S[0].pointerId?S[1]:S[0];return x[t.pointerId]}this.rotateCamera=function(){const e=new r.Pa4,t=new r._fP,o=new r.Pa4,i=new r.Pa4,s=new r.Pa4,a=new r.Pa4;return function(){a.set(y.x-f.x,y.y-f.y,0);let r=a.length();r?(w.copy(n.object.position).sub(n.target),o.copy(w).normalize(),i.copy(n.object.up).normalize(),s.crossVectors(i,o).normalize(),i.setLength(y.y-f.y),s.setLength(y.x-f.x),a.copy(i.add(s)),e.crossVectors(a,w).normalize(),r*=n.rotateSpeed,t.setFromAxisAngle(e,r),w.applyQuaternion(t),n.object.up.applyQuaternion(t),b.copy(e),g=r):!n.staticMoving&&g&&(g*=Math.sqrt(1-n.dynamicDampingFactor),w.copy(n.object.position).sub(n.target),t.setFromAxisAngle(b,g),w.applyQuaternion(t),n.object.up.applyQuaternion(t)),f.copy(y)}}(),this.zoomCamera=function(){let e;h===o.TOUCH_ZOOM_PAN?(e=l/m,l=m,n.object.isPerspectiveCamera?w.multiplyScalar(e):n.object.isOrthographicCamera?(n.object.zoom/=e,n.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(e=1+(M.y-v.y)*n.zoomSpeed,1!==e&&e>0&&(n.object.isPerspectiveCamera?w.multiplyScalar(e):n.object.isOrthographicCamera?(n.object.zoom/=e,n.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),n.staticMoving?v.copy(M):v.y+=(M.y-v.y)*this.dynamicDampingFactor)},this.panCamera=function(){const e=new r.FM8,t=new r.Pa4,o=new r.Pa4;return function(){if(e.copy(E).sub(P),e.lengthSq()){if(n.object.isOrthographicCamera){const t=(n.object.right-n.object.left)/n.object.zoom/n.domElement.clientWidth,o=(n.object.top-n.object.bottom)/n.object.zoom/n.domElement.clientWidth;e.x*=t,e.y*=o}e.multiplyScalar(w.length()*n.panSpeed),o.copy(w).cross(n.object.up).setLength(e.x),o.add(t.copy(n.object.up).setLength(e.y)),n.object.position.add(o),n.target.add(o),n.staticMoving?P.copy(E):P.add(e.subVectors(E,P).multiplyScalar(n.dynamicDampingFactor))}}}(),this.checkDistances=function(){n.noZoom&&n.noPan||(w.lengthSq()>n.maxDistance*n.maxDistance&&(n.object.position.addVectors(n.target,w.setLength(n.maxDistance)),v.copy(M)),w.lengthSq()<n.minDistance*n.minDistance&&(n.object.position.addVectors(n.target,w.setLength(n.minDistance)),v.copy(M)))},this.update=function(){w.subVectors(n.object.position,n.target),n.noRotate||n.rotateCamera(),n.noZoom||n.zoomCamera(),n.noPan||n.panCamera(),n.object.position.addVectors(n.target,w),n.object.isPerspectiveCamera?(n.checkDistances(),n.object.lookAt(n.target),s.distanceToSquared(n.object.position)>i&&(n.dispatchEvent(d),s.copy(n.object.position))):n.object.isOrthographicCamera?(n.object.lookAt(n.target),(s.distanceToSquared(n.object.position)>i||a!==n.object.zoom)&&(n.dispatchEvent(d),s.copy(n.object.position),a=n.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){h=o.NONE,c=o.NONE,n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.up.copy(n.up0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),w.subVectors(n.object.position,n.target),n.object.lookAt(n.target),n.dispatchEvent(d),s.copy(n.object.position),a=n.object.zoom},this.dispose=function(){n.domElement.removeEventListener("contextmenu",z),n.domElement.removeEventListener("pointerdown",C),n.domElement.removeEventListener("pointercancel",I),n.domElement.removeEventListener("wheel",O),n.domElement.removeEventListener("pointermove",T),n.domElement.removeEventListener("pointerup",K),window.removeEventListener("keydown",_),window.removeEventListener("keyup",A)},this.domElement.addEventListener("contextmenu",z),this.domElement.addEventListener("pointerdown",C),this.domElement.addEventListener("pointercancel",I),this.domElement.addEventListener("wheel",O,{passive:!1}),window.addEventListener("keydown",_),window.addEventListener("keyup",A),this.handleResize(),this.update()}}const g=new r.iMs,w=new r.Pa4,f=new r.Pa4,y=new r._fP,b={X:new r.Pa4(1,0,0),Y:new r.Pa4(0,1,0),Z:new r.Pa4(0,0,1)},v={type:"change"},M={type:"mouseDown"},P={type:"mouseUp",mode:null},E={type:"objectChange"};class S extends r.Tme{constructor(e,t){super(),void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";const n=new Q;this._gizmo=n,this.add(n);const o=new B;this._plane=o,this.add(o);const i=this;function s(e,t){let s=t;Object.defineProperty(i,e,{get:function(){return void 0!==s?s:t},set:function(t){s!==t&&(s=t,o[e]=t,n[e]=t,i.dispatchEvent({type:e+"-changed",value:t}),i.dispatchEvent(v))}}),i[e]=t,o[e]=t,n[e]=t}s("camera",e),s("object",void 0),s("enabled",!0),s("axis",null),s("mode","translate"),s("translationSnap",null),s("rotationSnap",null),s("scaleSnap",null),s("space","world"),s("size",1),s("dragging",!1),s("showX",!0),s("showY",!0),s("showZ",!0);const a=new r.Pa4,h=new r.Pa4,c=new r._fP,l=new r._fP,d=new r.Pa4,p=new r._fP,u=new r.Pa4,m=new r.Pa4,g=new r.Pa4,w=0,f=new r.Pa4;s("worldPosition",a),s("worldPositionStart",h),s("worldQuaternion",c),s("worldQuaternionStart",l),s("cameraPosition",d),s("cameraQuaternion",p),s("pointStart",u),s("pointEnd",m),s("rotationAxis",g),s("rotationAngle",w),s("eye",f),this._offset=new r.Pa4,this._startNorm=new r.Pa4,this._endNorm=new r.Pa4,this._cameraScale=new r.Pa4,this._parentPosition=new r.Pa4,this._parentQuaternion=new r._fP,this._parentQuaternionInv=new r._fP,this._parentScale=new r.Pa4,this._worldScaleStart=new r.Pa4,this._worldQuaternionInv=new r._fP,this._worldScale=new r.Pa4,this._positionStart=new r.Pa4,this._quaternionStart=new r._fP,this._scaleStart=new r.Pa4,this._getPointer=x.bind(this),this._onPointerDown=G.bind(this),this._onPointerHover=j.bind(this),this._onPointerMove=C.bind(this),this._onPointerUp=T.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(void 0===this.object||!0===this.dragging)return;g.setFromCamera(e,this.camera);const t=K(this._gizmo.picker[this.mode],g);this.axis=t?t.object.name:null}pointerDown(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){g.setFromCamera(e,this.camera);const t=K(this._plane,g,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,M.mode=this.mode,this.dispatchEvent(M)}}pointerMove(e){const t=this.axis,n=this.mode,o=this.object;let i=this.space;if("scale"===n?i="local":"E"!==t&&"XYZE"!==t&&"XYZ"!==t||(i="world"),void 0===o||null===t||!1===this.dragging||-1!==e.button)return;g.setFromCamera(e,this.camera);const s=K(this._plane,g,!0);if(s){if(this.pointEnd.copy(s.point).sub(this.worldPositionStart),"translate"===n)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===i&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===i&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),o.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===i&&(o.position.applyQuaternion(y.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(o.position.x=Math.round(o.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(o.position.y=Math.round(o.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(o.position.z=Math.round(o.position.z/this.translationSnap)*this.translationSnap),o.position.applyQuaternion(this._quaternionStart)),"world"===i&&(o.parent&&o.position.add(w.setFromMatrixPosition(o.parent.matrixWorld)),-1!==t.search("X")&&(o.position.x=Math.round(o.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(o.position.y=Math.round(o.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(o.position.z=Math.round(o.position.z/this.translationSnap)*this.translationSnap),o.parent&&o.position.sub(w.setFromMatrixPosition(o.parent.matrixWorld))));else if("scale"===n){if(-1!==t.search("XYZ")){let e=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(e*=-1),f.set(e,e,e)}else w.copy(this.pointStart),f.copy(this.pointEnd),w.applyQuaternion(this._worldQuaternionInv),f.applyQuaternion(this._worldQuaternionInv),f.divide(w),-1===t.search("X")&&(f.x=1),-1===t.search("Y")&&(f.y=1),-1===t.search("Z")&&(f.z=1);o.scale.copy(this._scaleStart).multiply(f),this.scaleSnap&&(-1!==t.search("X")&&(o.scale.x=Math.round(o.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(o.scale.y=Math.round(o.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(o.scale.z=Math.round(o.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===n){this._offset.copy(this.pointEnd).sub(this.pointStart);const e=20/this.worldPosition.distanceTo(w.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(w.copy(this.rotationAxis).cross(this.eye))*e):"X"!==t&&"Y"!==t&&"Z"!==t||(this.rotationAxis.copy(b[t]),w.copy(b[t]),"local"===i&&w.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(w.cross(this.eye).normalize())*e),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===i&&"E"!==t&&"XYZE"!==t?(o.quaternion.copy(this._quaternionStart),o.quaternion.multiply(y.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),o.quaternion.copy(y.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),o.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(v),this.dispatchEvent(E)}}pointerUp(e){0===e.button&&(this.dragging&&null!==this.axis&&(P.mode=this.mode,this.dispatchEvent(P)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse((function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}))}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(v),this.dispatchEvent(E),this.pointStart.copy(this.pointEnd))}getRaycaster(){return g}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}update(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}}function x(e){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:e.button};{const t=this.domElement.getBoundingClientRect();return{x:(e.clientX-t.left)/t.width*2-1,y:-(e.clientY-t.top)/t.height*2+1,button:e.button}}}function j(e){if(this.enabled)switch(e.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(e));break}}function G(e){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(e)),this.pointerDown(this._getPointer(e)))}function C(e){this.enabled&&this.pointerMove(this._getPointer(e))}function T(e){this.enabled&&(this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(e)))}function K(e,t,n){const o=t.intersectObject(e,!0);for(let i=0;i<o.length;i++)if(o[i].object.visible||n)return o[i];return!1}S.prototype.isTransformControls=!0;const I=new r.USm,_=new r.Pa4(0,1,0),A=new r.Pa4(0,0,0),R=new r.yGw,k=new r._fP,X=new r._fP,O=new r.Pa4,D=new r.yGw,Y=new r.Pa4(1,0,0),H=new r.Pa4(0,1,0),z=new r.Pa4(0,0,1),L=new r.Pa4,Z=new r.Pa4,F=new r.Pa4;class Q extends r.Tme{constructor(){super(),this.type="TransformControlsGizmo";const e=new r.vBJ({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new r.nls({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),n=e.clone();n.opacity=.15;const o=t.clone();o.opacity=.5;const i=e.clone();i.color.setHex(16711680);const s=e.clone();s.color.setHex(65280);const a=e.clone();a.color.setHex(255);const h=e.clone();h.color.setHex(16711680),h.opacity=.5;const c=e.clone();c.color.setHex(65280),c.opacity=.5;const l=e.clone();l.color.setHex(255),l.opacity=.5;const d=e.clone();d.opacity=.25;const p=e.clone();p.color.setHex(16776960),p.opacity=.25;const u=e.clone();u.color.setHex(16776960);const m=e.clone();m.color.setHex(7895160);const g=new r.fHI(0,.04,.1,12);g.translate(0,.05,0);const w=new r.DvJ(.08,.08,.08);w.translate(0,.04,0);const f=new r.u9r;f.setAttribute("position",new r.a$l([0,0,0,1,0,0],3));const y=new r.fHI(.0075,.0075,.5,3);function b(e,t){const n=new r.XvJ(e,.0075,3,64,t*Math.PI*2);return n.rotateY(Math.PI/2),n.rotateX(Math.PI/2),n}function v(){const e=new r.u9r;return e.setAttribute("position",new r.a$l([0,0,0,1,1,1],3)),e}y.translate(0,.25,0);const M={X:[[new r.Kj0(g,i),[.5,0,0],[0,0,-Math.PI/2]],[new r.Kj0(g,i),[-.5,0,0],[0,0,Math.PI/2]],[new r.Kj0(y,i),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new r.Kj0(g,s),[0,.5,0]],[new r.Kj0(g,s),[0,-.5,0],[Math.PI,0,0]],[new r.Kj0(y,s)]],Z:[[new r.Kj0(g,a),[0,0,.5],[Math.PI/2,0,0]],[new r.Kj0(g,a),[0,0,-.5],[-Math.PI/2,0,0]],[new r.Kj0(y,a),null,[Math.PI/2,0,0]]],XYZ:[[new r.Kj0(new r.pQR(.1,0),d.clone()),[0,0,0]]],XY:[[new r.Kj0(new r.DvJ(.15,.15,.01),l.clone()),[.15,.15,0]]],YZ:[[new r.Kj0(new r.DvJ(.15,.15,.01),h.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new r.Kj0(new r.DvJ(.15,.15,.01),c.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},P={X:[[new r.Kj0(new r.fHI(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new r.Kj0(new r.fHI(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new r.Kj0(new r.fHI(.2,0,.6,4),n),[0,.3,0]],[new r.Kj0(new r.fHI(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new r.Kj0(new r.fHI(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new r.Kj0(new r.fHI(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new r.Kj0(new r.pQR(.2,0),n)]],XY:[[new r.Kj0(new r.DvJ(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new r.Kj0(new r.DvJ(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new r.Kj0(new r.DvJ(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]]},E={START:[[new r.Kj0(new r.pQR(.01,2),o),null,null,null,"helper"]],END:[[new r.Kj0(new r.pQR(.01,2),o),null,null,null,"helper"]],DELTA:[[new r.x12(v(),o),null,null,null,"helper"]],X:[[new r.x12(f,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new r.x12(f,o.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new r.x12(f,o.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},S={XYZE:[[new r.Kj0(b(.5,1),m),null,[0,Math.PI/2,0]]],X:[[new r.Kj0(b(.5,.5),i)]],Y:[[new r.Kj0(b(.5,.5),s),null,[0,0,-Math.PI/2]]],Z:[[new r.Kj0(b(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new r.Kj0(b(.75,1),p),null,[0,Math.PI/2,0]]]},x={AXIS:[[new r.x12(f,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},j={XYZE:[[new r.Kj0(new r.xo$(.25,10,8),n)]],X:[[new r.Kj0(new r.XvJ(.5,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new r.Kj0(new r.XvJ(.5,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new r.Kj0(new r.XvJ(.5,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new r.Kj0(new r.XvJ(.75,.1,2,24),n)]]},G={X:[[new r.Kj0(w,i),[.5,0,0],[0,0,-Math.PI/2]],[new r.Kj0(y,i),[0,0,0],[0,0,-Math.PI/2]],[new r.Kj0(w,i),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new r.Kj0(w,s),[0,.5,0]],[new r.Kj0(y,s)],[new r.Kj0(w,s),[0,-.5,0],[0,0,Math.PI]]],Z:[[new r.Kj0(w,a),[0,0,.5],[Math.PI/2,0,0]],[new r.Kj0(y,a),[0,0,0],[Math.PI/2,0,0]],[new r.Kj0(w,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new r.Kj0(new r.DvJ(.15,.15,.01),l),[.15,.15,0]]],YZ:[[new r.Kj0(new r.DvJ(.15,.15,.01),h),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new r.Kj0(new r.DvJ(.15,.15,.01),c),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new r.Kj0(new r.DvJ(.1,.1,.1),d.clone())]]},C={X:[[new r.Kj0(new r.fHI(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new r.Kj0(new r.fHI(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new r.Kj0(new r.fHI(.2,0,.6,4),n),[0,.3,0]],[new r.Kj0(new r.fHI(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new r.Kj0(new r.fHI(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new r.Kj0(new r.fHI(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new r.Kj0(new r.DvJ(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new r.Kj0(new r.DvJ(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new r.Kj0(new r.DvJ(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new r.Kj0(new r.DvJ(.2,.2,.2),n),[0,0,0]]]},T={X:[[new r.x12(f,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new r.x12(f,o.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new r.x12(f,o.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function K(e){const t=new r.Tme;for(const n in e)for(let o=e[n].length;o--;){const i=e[n][o][0].clone(),s=e[n][o][1],r=e[n][o][2],a=e[n][o][3],h=e[n][o][4];i.name=n,i.tag=h,s&&i.position.set(s[0],s[1],s[2]),r&&i.rotation.set(r[0],r[1],r[2]),a&&i.scale.set(a[0],a[1],a[2]),i.updateMatrix();const c=i.geometry.clone();c.applyMatrix4(i.matrix),i.geometry=c,i.renderOrder=1/0,i.position.set(0,0,0),i.rotation.set(0,0,0),i.scale.set(1,1,1),t.add(i)}return t}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo["translate"]=K(M)),this.add(this.gizmo["rotate"]=K(S)),this.add(this.gizmo["scale"]=K(G)),this.add(this.picker["translate"]=K(P)),this.add(this.picker["rotate"]=K(j)),this.add(this.picker["scale"]=K(C)),this.add(this.helper["translate"]=K(E)),this.add(this.helper["rotate"]=K(x)),this.add(this.helper["scale"]=K(T)),this.picker["translate"].visible=!1,this.picker["rotate"].visible=!1,this.picker["scale"].visible=!1}updateMatrixWorld(e){const t="scale"===this.mode?"local":this.space,n="local"===t?this.worldQuaternion:X;this.gizmo["translate"].visible="translate"===this.mode,this.gizmo["rotate"].visible="rotate"===this.mode,this.gizmo["scale"].visible="scale"===this.mode,this.helper["translate"].visible="translate"===this.mode,this.helper["rotate"].visible="rotate"===this.mode,this.helper["scale"].visible="scale"===this.mode;let o=[];o=o.concat(this.picker[this.mode].children),o=o.concat(this.gizmo[this.mode].children),o=o.concat(this.helper[this.mode].children);for(let i=0;i<o.length;i++){const e=o[i];let t;if(e.visible=!0,e.rotation.set(0,0,0),e.position.copy(this.worldPosition),t=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),e.scale.set(1,1,1).multiplyScalar(t*this.size/4),"helper"!==e.tag){if(e.quaternion.copy(n),"translate"===this.mode||"scale"===this.mode){const t=.99,o=.2;"X"===e.name&&Math.abs(_.copy(Y).applyQuaternion(n).dot(this.eye))>t&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"Y"===e.name&&Math.abs(_.copy(H).applyQuaternion(n).dot(this.eye))>t&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"Z"===e.name&&Math.abs(_.copy(z).applyQuaternion(n).dot(this.eye))>t&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"XY"===e.name&&Math.abs(_.copy(z).applyQuaternion(n).dot(this.eye))<o&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"YZ"===e.name&&Math.abs(_.copy(Y).applyQuaternion(n).dot(this.eye))<o&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"XZ"===e.name&&Math.abs(_.copy(H).applyQuaternion(n).dot(this.eye))<o&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1)}else"rotate"===this.mode&&(k.copy(n),_.copy(this.eye).applyQuaternion(y.copy(n).invert()),-1!==e.name.search("E")&&e.quaternion.setFromRotationMatrix(R.lookAt(this.eye,A,H)),"X"===e.name&&(y.setFromAxisAngle(Y,Math.atan2(-_.y,_.z)),y.multiplyQuaternions(k,y),e.quaternion.copy(y)),"Y"===e.name&&(y.setFromAxisAngle(H,Math.atan2(_.x,_.z)),y.multiplyQuaternions(k,y),e.quaternion.copy(y)),"Z"===e.name&&(y.setFromAxisAngle(z,Math.atan2(_.y,_.x)),y.multiplyQuaternions(k,y),e.quaternion.copy(y)));e.visible=e.visible&&(-1===e.name.indexOf("X")||this.showX),e.visible=e.visible&&(-1===e.name.indexOf("Y")||this.showY),e.visible=e.visible&&(-1===e.name.indexOf("Z")||this.showZ),e.visible=e.visible&&(-1===e.name.indexOf("E")||this.showX&&this.showY&&this.showZ),e.material._color=e.material._color||e.material.color.clone(),e.material._opacity=e.material._opacity||e.material.opacity,e.material.color.copy(e.material._color),e.material.opacity=e.material._opacity,this.enabled&&this.axis&&(e.name===this.axis||this.axis.split("").some((function(t){return e.name===t})))&&(e.material.color.setHex(16776960),e.material.opacity=1)}else e.visible=!1,"AXIS"===e.name?(e.position.copy(this.worldPositionStart),e.visible=!!this.axis,"X"===this.axis&&(y.setFromEuler(I.set(0,0,0)),e.quaternion.copy(n).multiply(y),Math.abs(_.copy(Y).applyQuaternion(n).dot(this.eye))>.9&&(e.visible=!1)),"Y"===this.axis&&(y.setFromEuler(I.set(0,0,Math.PI/2)),e.quaternion.copy(n).multiply(y),Math.abs(_.copy(H).applyQuaternion(n).dot(this.eye))>.9&&(e.visible=!1)),"Z"===this.axis&&(y.setFromEuler(I.set(0,Math.PI/2,0)),e.quaternion.copy(n).multiply(y),Math.abs(_.copy(z).applyQuaternion(n).dot(this.eye))>.9&&(e.visible=!1)),"XYZE"===this.axis&&(y.setFromEuler(I.set(0,Math.PI/2,0)),_.copy(this.rotationAxis),e.quaternion.setFromRotationMatrix(R.lookAt(A,_,H)),e.quaternion.multiply(y),e.visible=this.dragging),"E"===this.axis&&(e.visible=!1)):"START"===e.name?(e.position.copy(this.worldPositionStart),e.visible=this.dragging):"END"===e.name?(e.position.copy(this.worldPosition),e.visible=this.dragging):"DELTA"===e.name?(e.position.copy(this.worldPositionStart),e.quaternion.copy(this.worldQuaternionStart),w.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),w.applyQuaternion(this.worldQuaternionStart.clone().invert()),e.scale.copy(w),e.visible=this.dragging):(e.quaternion.copy(n),this.dragging?e.position.copy(this.worldPositionStart):e.position.copy(this.worldPosition),this.axis&&(e.visible=-1!==this.axis.search(e.name)))}super.updateMatrixWorld(e)}}Q.prototype.isTransformControlsGizmo=!0;class B extends r.Kj0{constructor(){super(new r._12(1e5,1e5,2,2),new r.vBJ({visible:!1,wireframe:!0,side:r.ehD,transparent:!0,opacity:.1,toneMapped:!1})),this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),L.copy(Y).applyQuaternion("local"===t?this.worldQuaternion:X),Z.copy(H).applyQuaternion("local"===t?this.worldQuaternion:X),F.copy(z).applyQuaternion("local"===t?this.worldQuaternion:X),_.copy(Z),this.mode){case"translate":case"scale":switch(this.axis){case"X":_.copy(this.eye).cross(L),O.copy(L).cross(_);break;case"Y":_.copy(this.eye).cross(Z),O.copy(Z).cross(_);break;case"Z":_.copy(this.eye).cross(F),O.copy(F).cross(_);break;case"XY":O.copy(F);break;case"YZ":O.copy(L);break;case"XZ":_.copy(F),O.copy(Z);break;case"XYZ":case"E":O.set(0,0,0);break}break;case"rotate":default:O.set(0,0,0)}0===O.length()?this.quaternion.copy(this.cameraQuaternion):(D.lookAt(w.set(0,0,0),O,_),this.quaternion.setFromRotationMatrix(D)),super.updateMatrixWorld(e)}}B.prototype.isTransformControlsPlane=!0;const J=new r.JOQ,N=new r.iMs,W=new r.FM8,q=new r.Pa4,U=new r.Pa4,$=new r.Pa4,V=new r.yGw;class ee extends r.pBf{constructor(e,t,n){super(),n.style.touchAction="none";let o=null,i=null;const s=[],r=this;function a(){n.addEventListener("pointermove",p),n.addEventListener("pointerdown",u),n.addEventListener("pointerup",m),n.addEventListener("pointerleave",m)}function h(){n.removeEventListener("pointermove",p),n.removeEventListener("pointerdown",u),n.removeEventListener("pointerup",m),n.removeEventListener("pointerleave",m),n.style.cursor=""}function c(){h()}function l(){return e}function d(){return N}function p(a){if(!1!==r.enabled){if(g(a),N.setFromCamera(W,t),o)return N.ray.intersectPlane(J,U)&&o.position.copy(U.sub(q).applyMatrix4(V)),void r.dispatchEvent({type:"drag",object:o});if("mouse"===a.pointerType||"pen"===a.pointerType)if(s.length=0,N.setFromCamera(W,t),N.intersectObjects(e,!0,s),s.length>0){const e=s[0].object;J.setFromNormalAndCoplanarPoint(t.getWorldDirection(J.normal),$.setFromMatrixPosition(e.matrixWorld)),i!==e&&null!==i&&(r.dispatchEvent({type:"hoveroff",object:i}),n.style.cursor="auto",i=null),i!==e&&(r.dispatchEvent({type:"hoveron",object:e}),n.style.cursor="pointer",i=e)}else null!==i&&(r.dispatchEvent({type:"hoveroff",object:i}),n.style.cursor="auto",i=null)}}function u(i){!1!==r.enabled&&(g(i),s.length=0,N.setFromCamera(W,t),N.intersectObjects(e,!0,s),s.length>0&&(o=!0===r.transformGroup?e[0]:s[0].object,J.setFromNormalAndCoplanarPoint(t.getWorldDirection(J.normal),$.setFromMatrixPosition(o.matrixWorld)),N.ray.intersectPlane(J,U)&&(V.copy(o.parent.matrixWorld).invert(),q.copy(U).sub($.setFromMatrixPosition(o.matrixWorld))),n.style.cursor="move",r.dispatchEvent({type:"dragstart",object:o})))}function m(){!1!==r.enabled&&(o&&(r.dispatchEvent({type:"dragend",object:o}),o=null),n.style.cursor=i?"pointer":"auto")}function g(e){const t=n.getBoundingClientRect();W.x=(e.clientX-t.left)/t.width*2-1,W.y=-(e.clientY-t.top)/t.height*2+1}a(),this.enabled=!0,this.transformGroup=!1,this.activate=a,this.deactivate=h,this.dispose=c,this.getObjects=l,this.getRaycaster=d}}var te=n(3466),ne=n.n(te),oe=n(4376);let ie;var se={name:"Demo30",data(){return{scene:null,camera:null,renderer:null,axes:null,stats:null,ctrlObj:null,controls:{orbitControls:null,trackballControls:null,transformControls:null,dragControls:null},plane:null,planeGeo:null,planeMat:null,circle:null,circleGeo:null,circleMat:null,ring:null,ringGeo:null,ringMat:null,box:null,boxGeo:null,boxMat:null,sphere:null,sphereGeo:null,sphereMat:null,cylinder:null,cylinderGeo:null,cylinderMat:null,cone:null,coneGeo:null,coneMat:null,torus:null,torusGeo:null,torusMat:null,torusKnot:null,torusKnotGeo:null,torusKnotMat:null,icosahedron:null,icosahedronGeo:null,icosahedronMat:null,tetrahedron:null,tetrahedronGeo:null,tetrahedronMat:null,octahedron:null,octahedronGeo:null,octahedronMat:null,dodecahedron:null,dodecahedronGeo:null,dodecahedronMat:null,group:null,step:.01,canDragMeshs:[]}},mounted(){ie=this,this.init(),window.addEventListener("keydown",this.onKeyDown.bind(this)),window.addEventListener("keyup",this.onKeyUp.bind(this)),window.addEventListener("resize",this.onWindowResize.bind(this)),this.$watch("scene.children",(function(){this.createDragControls()}))},methods:{init(){this.scene=new r.xsS,this.camera=new r.cPb(75,window.innerWidth/window.innerHeight/2,.1,1e3),this.renderer=new r.CP7,this.renderer.setClearColor(new r.Ilk(0)),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.shadowMap.enabled=!0,document.getElementById("demo30Id").appendChild(this.renderer.domElement),this.axes=new r.y8_(50),this.scene.add(this.axes);const e=new r.Mig(16777215);this.scene.add(e),this.camera.position.x=0,this.camera.position.y=0,this.camera.position.z=120,this.camera.lookAt(this.scene.position),this.scene.add(this.camera),this.addStats(),this.group=new r.ZAu,this.scene.add(this.group),this.addGeometry(),this.addGeometryFolder(),this.createTrackballControls(),this.createTransformControls(),this.createDragControls(),this.renderScene()},addGeometry(){this.planeGeo=new r._12(4,8,4,8),this.planeMat=new r.vBJ({color:16711680}),this.planeMat.side=r.ehD,this.planeMat.wireframe=!0,this.plane=new r.Kj0(this.planeGeo,this.planeMat),this.group.add(this.plane),this.circleGeo=new r.zf8(4,10,0,2*Math.PI),this.circleMat=new r.vBJ({color:65280,wireframe:!0,side:r.ehD}),this.circle=new r.Kj0(this.circleGeo,this.circleMat),this.circle.translateX(20),this.group.add(this.circle),this.ringGeo=new r.o8S(3,4,8,8,0,2*Math.PI),this.ringMat=new r.vBJ({color:16711935,wireframe:!0,side:r.ehD}),this.ring=new r.Kj0(this.ringGeo,this.ringMat),this.ring.translateX(40),this.group.add(this.ring),this.boxGeo=new r.DvJ(3,4,2,3,4,2),this.boxMat=new r.vBJ({color:255,wireframe:!0}),this.box=new r.Kj0(this.boxGeo,this.boxMat),this.box.translateY(20),this.group.add(this.box),this.sphereGeo=new r.xo$(3,8,8,0,2*Math.PI,0,2*Math.PI),this.sphereMat=new r.vBJ({color:16777215,wireframe:!0}),this.sphere=new r.Kj0(this.sphereGeo,this.sphereMat),this.sphere.translateX(20),this.sphere.translateY(20),this.group.add(this.sphere),this.cylinderGeo=new r.fHI(2,2,4,8,4,!0,0,2*Math.PI),this.cylinderMat=new r.vBJ({color:65535,wireframe:!0}),this.cylinder=new r.Kj0(this.cylinderGeo,this.cylinderMat),this.cylinder.translateX(40),this.cylinder.translateY(20),this.group.add(this.cylinder),this.coneGeo=new r.b_z(2,4,8,4,!0,0,2*Math.PI),this.coneMat=new r.vBJ({color:16776960,wireframe:!0}),this.cone=new r.Kj0(this.coneGeo,this.coneMat),this.cone.translateX(60),this.cone.translateY(20),this.group.add(this.cone),this.torusGeo=new r.XvJ(3,1,8,8,2*Math.PI),this.torusMat=new r.vBJ({color:16711680,wireframe:!0}),this.torus=new r.Kj0(this.torusGeo,this.torusMat),this.torus.translateY(40),this.group.add(this.torus),this.torusKnotGeo=new r.FE5(3,1,60,20,2,3),this.torusKnotMat=new r.vBJ({color:65280,wireframe:!0}),this.torusKnot=new r.Kj0(this.torusKnotGeo,this.torusKnotMat),this.torusKnot.translateY(40),this.torusKnot.translateX(20),this.group.add(this.torusKnot),this.icosahedronGeo=new r.cJO(4,0),this.icosahedronMat=new r.vBJ({color:16776960,wireframe:!0}),this.icosahedron=new r.Kj0(this.icosahedronGeo,this.icosahedronMat),this.icosahedron.translateY(60),this.group.add(this.icosahedron),this.tetrahedronGeo=new r.H$k(4,0),this.tetrahedronMat=new r.vBJ({color:16777215,wireframe:!0}),this.tetrahedron=new r.Kj0(this.tetrahedronGeo,this.tetrahedronMat),this.tetrahedron.translateY(60),this.tetrahedron.translateX(20),this.group.add(this.tetrahedron),this.octahedronGeo=new r.pQR(4,0),this.octahedronMat=new r.vBJ({color:65535,wireframe:!0}),this.octahedron=new r.Kj0(this.octahedronGeo,this.octahedronMat),this.octahedron.translateY(60),this.octahedron.translateX(40),this.group.add(this.octahedron),this.dodecahedronGeo=new r.Kgo(4,0),this.dodecahedronMat=new r.vBJ({color:16711935,wireframe:!0}),this.dodecahedron=new r.Kj0(this.dodecahedronGeo,this.dodecahedronMat),this.dodecahedron.translateY(60),this.dodecahedron.translateX(60),this.group.add(this.dodecahedron)},addGeometryFolder(){this.ctrlObj={width:4,height:8,widthSegments:4,heightSegments:8,circleRadius:4,circleSegments:10,circleThetaStart:0,circleThetaLength:2*Math.PI,ringInnerRadius:3,ringOuterRadius:4,ringThetaSegments:8,ringPhiSegments:8,ringThetaStart:0,ringThetaLength:2*Math.PI,boxWidth:3,boxHeight:4,boxDepth:2,boxWidthSegments:3,boxHeightSegments:4,boxDepthSegments:5,sphereRadius:3,sphereWidthSegments:8,sphereHeightSegments:8,spherePhiStart:0,spherePhiLength:2*Math.PI,sphereThetaStart:0,sphereThetaLength:2*Math.PI,cylinderRadiusTop:2,cylinderRadiusBottom:2,cylinderHeight:4,cylinderRadialSegments:8,cylinderHeightSegments:4,cylinderOpenEnded:!0,cylinderThetaStart:0,cylinderThetaLength:2*Math.PI,coneRadius:2,coneHeight:4,coneRadialSegments:8,coneHeightSegments:4,coneOpenEnded:!0,coneThetaStart:0,coneThetaLength:2*Math.PI,torusRadius:3,torusTube:1,torusRadialSegments:8,torusTubularSegments:8,torusArc:2*Math.PI,torusKnotRadius:3,torusKnotTube:1,torusKnotTubularSegments:60,torusKnotRadialSegments:20,torusKnotP:2,torusKnotQ:3,icosahedronRadius:4,icosahedronDetail:0,tetrahedronRadius:4,tetrahedronDetail:0,octahedronRadius:4,octahedronDetail:0,dodecahedronRadius:4,dodecahedronDetail:0,grouping:!1,rotate:!0,saveCombineGeometry:()=>{const e=[];ie.group.children.forEach((t=>{if(t instanceof r.Kj0){t.geometry.deleteAttribute("normal"),t.geometry.deleteAttribute("uv");const n=c(t.geometry);n.applyMatrix4(t.matrixWorld),e.push(n)}}));const t=new r.vBJ({color:65535,wireframe:!0,side:r.ehD}),n=a(e),o=new r.Kj0(n,t),i=o.toJSON();localStorage.setItem("sceneJson",JSON.stringify(i))},saveTorusKnot:()=>{const e=ie.torusKnot.toJSON();localStorage.setItem("sceneJson",JSON.stringify(e))},load:()=>{const e=JSON.parse(localStorage.getItem("sceneJson"));if(!e)return void this.$Message.info("请先保存three对象");const t=new r.Gql,n=t.parse(e);n.geometry instanceof r.FE5?n.position.x=-30:n.position.x=-70,ie.scene.add(n),localStorage.removeItem("sceneJson")}};const e=this.ctrlObj,t=new oe.ZP.GUI,n=t.addFolder("plane");n.add(e,"width",0,20).onChange((function(){ie.editGeo("plane",e)})),n.add(e,"height",0,20).onChange((function(){ie.editGeo("plane",e)})),n.add(e,"widthSegments",1,20).onChange((function(){ie.editGeo("plane",e)})),n.add(e,"heightSegments",1,20).onChange((function(){ie.editGeo("plane",e)}));const o=t.addFolder("circle");o.add(e,"circleRadius",0,20).onChange((function(){ie.editGeo("circle",e)})),o.add(e,"circleSegments",1,50).onChange((function(){ie.editGeo("circle",e)})),o.add(e,"circleThetaStart",0,2*Math.PI).onChange((function(){ie.editGeo("circle",e)})),o.add(e,"circleThetaLength",0,2*Math.PI).onChange((function(){ie.editGeo("circle",e)}));const i=t.addFolder("ring");i.add(e,"ringInnerRadius",0,20).onChange((function(){ie.editGeo("ring",e)})),i.add(e,"ringOuterRadius",0,20).onChange((function(){ie.editGeo("ring",e)})),i.add(e,"ringThetaSegments",0,20).onChange((function(){ie.editGeo("ring",e)})),i.add(e,"ringPhiSegments",0,20).onChange((function(){ie.editGeo("ring",e)})),i.add(e,"ringThetaStart",0,2*Math.PI).onChange((function(){ie.editGeo("ring",e)})),i.add(e,"ringThetaLength",0,2*Math.PI).onChange((function(){ie.editGeo("ring",e)}));const s=t.addFolder("box");s.add(e,"boxWidth",0,20).onChange((function(){ie.editGeo("box",e)})),s.add(e,"boxHeight",0,20).onChange((function(){ie.editGeo("box",e)})),s.add(e,"boxDepth",0,20).onChange((function(){ie.editGeo("box",e)})),s.add(e,"boxWidthSegments",1,20).onChange((function(){ie.editGeo("box",e)})),s.add(e,"boxHeightSegments",1,20).onChange((function(){ie.editGeo("box",e)})),s.add(e,"boxDepthSegments",1,20).onChange((function(){ie.editGeo("box",e)}));const h=t.addFolder("sphere");h.add(e,"sphereRadius",0,20).onChange((function(){ie.editGeo("sphere",e)})),h.add(e,"sphereWidthSegments",0,20).onChange((function(){ie.editGeo("sphere",e)})),h.add(e,"sphereHeightSegments",0,20).onChange((function(){ie.editGeo("sphere",e)})),h.add(e,"spherePhiStart",0,2*Math.PI).onChange((function(){ie.editGeo("sphere",e)})),h.add(e,"spherePhiLength",0,2*Math.PI).onChange((function(){ie.editGeo("sphere",e)})),h.add(e,"sphereThetaStart",0,2*Math.PI).onChange((function(){ie.editGeo("sphere",e)})),h.add(e,"sphereThetaLength",0,2*Math.PI).onChange((function(){ie.editGeo("sphere",e)}));const l=t.addFolder("cylinder");l.add(e,"cylinderRadiusTop",-10,10).onChange((function(){ie.editGeo("cylinder",e)})),l.add(e,"cylinderRadiusBottom",-10,10).onChange((function(){ie.editGeo("cylinder",e)})),l.add(e,"cylinderHeight",0,20).onChange((function(){ie.editGeo("cylinder",e)})),l.add(e,"cylinderRadialSegments",1,20).onChange((function(){ie.editGeo("cylinder",e)})),l.add(e,"cylinderHeightSegments",1,20).onChange((function(){ie.editGeo("cylinder",e)})),l.add(e,"cylinderOpenEnded",!0,!1).onChange((function(){ie.editGeo("cylinder",e)})),l.add(e,"cylinderThetaStart",0,2*Math.PI).onChange((function(){ie.editGeo("cylinder",e)})),l.add(e,"cylinderThetaLength",0,2*Math.PI).onChange((function(){ie.editGeo("cylinder",e)}));const d=t.addFolder("cone");d.add(e,"coneRadius",0,10).onChange((function(){ie.editGeo("cone",e)})),d.add(e,"coneHeight",0,20).onChange((function(){ie.editGeo("cone",e)})),d.add(e,"coneRadialSegments",1,20).onChange((function(){ie.editGeo("cone",e)})),d.add(e,"coneHeightSegments",1,20).onChange((function(){ie.editGeo("cone",e)})),d.add(e,"coneOpenEnded",!0,!1).onChange((function(){ie.editGeo("cone",e)})),d.add(e,"coneThetaStart",0,2*Math.PI).onChange((function(){ie.editGeo("cone",e)})),d.add(e,"coneThetaLength",0,2*Math.PI).onChange((function(){ie.editGeo("cone",e)}));const p=t.addFolder("torus");p.add(e,"torusRadius",0,20).onChange((function(){ie.editGeo("torus",e)})),p.add(e,"torusTube",0,10).onChange((function(){ie.editGeo("torus",e)})),p.add(e,"torusRadialSegments",1,20).onChange((function(){ie.editGeo("torus",e)})),p.add(e,"torusTubularSegments",1,50).onChange((function(){ie.editGeo("torus",e)})),p.add(e,"torusArc",0,2*Math.PI).onChange((function(){ie.editGeo("torus",e)}));const u=t.addFolder("torusKnot");u.add(e,"torusKnotRadius",0,10).onChange((function(){ie.editGeo("torusKnot",e)})),u.add(e,"torusKnotTube",0,5).onChange((function(){ie.editGeo("torusKnot",e)})),u.add(e,"torusKnotTubularSegments",1,200).onChange((function(){ie.editGeo("torusKnot",e)})),u.add(e,"torusKnotRadialSegments",1,40).onChange((function(){ie.editGeo("torusKnot",e)})),u.add(e,"torusKnotP",1,10).onChange((function(){ie.editGeo("torusKnot",e)})),u.add(e,"torusKnotQ",0,10).onChange((function(){ie.editGeo("torusKnot",e)}));const m=t.addFolder("icosahedron");m.add(e,"icosahedronRadius",0,20).onChange((function(){ie.editGeo("icosahedron",e)})),m.add(e,"icosahedronDetail",0,5).step(1).onChange((function(){ie.editGeo("icosahedron",e)}));const g=t.addFolder("tetrahedron");g.add(e,"tetrahedronRadius",0,20).onChange((function(){ie.editGeo("tetrahedron",e)})),g.add(e,"tetrahedronDetail",0,5).step(1).onChange((function(){ie.editGeo("tetrahedron",e)}));const w=t.addFolder("octahedron");w.add(e,"octahedronRadius",0,20).onChange((function(){ie.editGeo("octahedron",e)})),w.add(e,"octahedronDetail",0,5).step(1).onChange((function(){ie.editGeo("octahedron",e)}));const f=t.addFolder("dodecahedron");f.add(e,"dodecahedronRadius",0,20).onChange((function(){ie.editGeo("dodecahedron",e)})),f.add(e,"dodecahedronDetail",0,5).step(1).onChange((function(){ie.editGeo("dodecahedron",e)}));const y=t.addFolder("group");y.add(e,"grouping"),y.add(e,"rotate");const b=t.addFolder("saveload");b.add(e,"saveTorusKnot"),b.add(e,"saveCombineGeometry"),b.add(e,"load")},renderScene(){this.stats.update(),this.controls.orbitControls?.update(),this.ctrlObj.grouping&&this.ctrlObj.rotate&&(this.group.rotation.y+=this.step),this.ctrlObj.rotate&&!this.ctrlObj.grouping&&this.group.children.forEach((e=>{e instanceof r.Kj0&&(e.rotation.y+=this.step)})),requestAnimationFrame(this.renderScene),this.renderer.render(ie.scene,this.camera)},addStats(){this.stats=new(ne()),this.stats.domElement.style.position="absolute",this.stats.domElement.style.left="0px",this.stats.domElement.style.top="0px",this.stats.setMode(0),document.getElementById("stats30Id").appendChild(this.stats.domElement)},onKeyDown(e){if(!e.repeat)switch(e.keyCode){case 17:(0,s.Ft)(this.controls.orbitControls)&&this.createOrbitControls(),this.controls.orbitControls.enabled||(this.controls.orbitControls.enabled=!0);break;default:break}},onKeyUp(e){switch(e.keyCode){case 17:this.controls.orbitControls.enabled&&(this.controls.orbitControls.enabled=!1);break;default:break}},onWindowResize(e){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)},createOrbitControls(){this.controls.orbitControls=new l.z(this.camera,this.renderer.domElement),this.controls.orbitControls.update()},createTrackballControls(){this.controls.trackballControls=new m(this.camera,this.renderer.domElement),this.controls.trackballControls.noPan=!0,this.controls.trackballControls.minDistance=1e3,this.controls.trackballControls.maxDistance=5e3},createTransformControls(){this.controls.transformControls=new S(this.camera,this.renderer.domElement),this.scene.add(this.controls.transformControls)},createDragControls(){this.canDragMeshs=[];for(let e=0;e<this.scene.children.length;e++){const t=this.scene.children[e];if(t.isGroup)for(let e=0;e<t.children.length;e++){const n=t.children[e];n.isMesh&&this.canDragMeshs.push(n)}t.isMesh&&this.canDragMeshs.push(t)}this.controls.dragControls=new ee(this.canDragMeshs,this.camera,this.renderer.domElement),this.controls.dragControls.addEventListener("hoveron",(e=>{this.controls.transformControls.attach(e.object)})),this.controls.dragControls.addEventListener("hoveroff",(e=>{this.controls.transformControls.detach(e.object)})),this.controls.dragControls.addEventListener("dragstart",(e=>{this.controls.trackballControls.enabled=!1})),this.controls.dragControls.addEventListener("dragend",(e=>{this.controls.trackballControls.enabled=!0}))},editGeo(e,t){switch(e){case"plane":this.group.remove(this.plane),this.planeGeo=new r._12(t.width,t.height,t.widthSegments,t.heightSegments),this.plane=new r.Kj0(this.planeGeo,this.planeMat),this.group.add(this.plane);break;case"circle":this.group.remove(this.circle),this.circleGeo=new r.zf8(t.circleRadius,t.circleSegments,t.circleThetaStart,t.circleThetaLength),this.circle=new r.Kj0(this.circleGeo,this.circleMat),this.group.add(this.circle),this.circle.translateX(20);break;case"ring":this.group.remove(this.ring),this.ringGeo=new r.o8S(t.ringInnerRadius,t.ringOuterRadius,t.ringThetaSegments,t.ringPhiSegments,t.ringThetaStart,t.ringThetaLength),this.ring=new r.Kj0(this.ringGeo,this.ringMat),this.group.add(this.ring),this.ring.translateX(40);break;case"box":this.group.remove(this.box),this.boxGeo=new r.DvJ(t.boxWidth,t.boxHeight,t.boxDepth,t.boxWidthSegments,t.boxHeightSegments,t.boxDepthSegments),this.box=new r.Kj0(this.boxGeo,this.boxMat),this.group.add(this.box),this.box.translateY(20);break;case"sphere":this.group.remove(this.sphere),this.sphereGeo=new r.xo$(t.sphereRadius,t.sphereWidthSegments,t.sphereHeightSegments,t.spherePhiStart,t.spherePhiLength,t.sphereThetaStart,t.sphereThetaLength),this.sphere=new r.Kj0(this.sphereGeo,this.sphereMat),this.group.add(this.sphere),this.sphere.translateX(20),this.sphere.translateY(20);break;case"cylinder":this.group.remove(this.cylinder),this.cylinderGeo=new r.fHI(t.cylinderRadiusTop,t.cylinderRadiusBottom,t.cylinderHeight,t.cylinderRadialSegments,t.cylinderHeightSegments,t.cylinderOpenEnded,t.cylinderThetaStart,t.cylinderThetaLength),this.cylinder=new r.Kj0(this.cylinderGeo,this.cylinderMat),this.group.add(this.cylinder),this.cylinder.translateX(40),this.cylinder.translateY(20);break;case"cone":this.group.remove(this.cone),this.coneGeo=new r.b_z(t.coneRadius,t.coneHeight,t.coneRadialSegments,t.coneHeightSegments,t.coneOpenEnded,t.coneThetaStart,t.coneThetaLength),this.cone=new r.Kj0(this.coneGeo,this.coneMat),this.group.add(this.cone),this.cone.translateX(60),this.cone.translateY(20);break;case"torus":this.group.remove(this.torus),this.torusGeo=new r.XvJ(t.torusRadius,t.torusTube,t.torusRadialSegments,t.torusTubularSegments,t.torusArc),this.torus=new r.Kj0(this.torusGeo,this.torusMat),this.group.add(this.torus),this.torus.translateY(40);break;case"torusKnot":this.group.remove(this.torusKnot),this.torusKnotGeo=new r.FE5(t.torusKnotRadius,t.torusKnotTube,t.torusKnotTubularSegments,t.torusKnotRadialSegments,Math.round(t.torusKnotP),Math.round(t.torusKnotQ)),this.torusKnot=new r.Kj0(this.torusKnotGeo,this.torusKnotMat),this.group.add(this.torusKnot),this.torusKnot.translateY(40),this.torusKnot.translateX(20);break;case"icosahedron":this.group.remove(this.icosahedron),this.icosahedronGeo=new r.cJO(t.icosahedronRadius,t.icosahedronDetail),this.icosahedron=new r.Kj0(this.icosahedronGeo,this.icosahedronMat),this.group.add(this.icosahedron),this.icosahedron.translateY(60);break;case"tetrahedron":this.group.remove(this.tetrahedron),this.tetrahedronGeo=new r.H$k(t.tetrahedronRadius,t.tetrahedronDetail),this.tetrahedron=new r.Kj0(this.tetrahedronGeo,this.tetrahedronMat),this.group.add(this.tetrahedron),this.tetrahedron.translateY(60),this.tetrahedron.translateX(20);break;case"octahedron":this.group.remove(this.octahedron),this.octahedronGeo=new r.pQR(t.octahedronRadius,t.octahedronDetail),this.octahedron=new r.Kj0(this.octahedronGeo,this.octahedronMat),this.group.add(this.octahedron),this.octahedron.translateY(60),this.octahedron.translateX(40);break;case"dodecahedron":this.group.remove(this.dodecahedron),this.dodecahedronGeo=new r.Kgo(t.dodecahedronRadius,t.dodecahedronDetail),this.dodecahedron=new r.Kj0(this.dodecahedronGeo,this.dodecahedronMat),this.group.add(this.dodecahedron),this.dodecahedron.translateY(60),this.dodecahedron.translateX(60);break;default:console.error("不存在的类型：",e);break}}}},re=se,ae=n(1001),he=(0,ae.Z)(re,o,i,!1,null,"350f4012",null),ce=he.exports}}]);